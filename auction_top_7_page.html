<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>Аукцион — Топ 7</title>
  <style>
    body { font-family: Arial, sans-serif; background:#f5f5f5; padding:30px; }
    h1 { text-align:center; }
    #timer { text-align:center; font-size:24px; margin-bottom:20px; }
    table { width:60%; margin:0 auto; border-collapse:collapse; background:white; }
    th, td { border:1px solid #ccc; padding:10px; text-align:center; }
    th { background:#eee; }
    .admin input { width:90%; }
  </style>
</head>
<body>

<h1>ТОП – 7</h1>
<div id="timer">До окончания аукциона: <span id="time"></span></div>

<table>
  <thead>
    <tr><th>Место</th><th>Имя</th></tr>
  </thead>
  <tbody id="tableBody"></tbody>
</table>

<script>
  const isAdmin = new URLSearchParams(window.location.search).get('admin') === 'true';

  let data = JSON.parse(localStorage.getItem('auctionData')) ||
    Array.from({length:7}, (_,i)=>({place:i+1,name:''}));

  function render(){
    const body = document.getElementById('tableBody');
    body.innerHTML='';
    data.forEach((row,i)=>{
      const tr=document.createElement('tr');
      tr.className = isAdmin ? 'admin' : '';
      tr.innerHTML = `<td>${row.place}</td>` +
        `<td>${isAdmin ? `<input value="${row.name}" onchange="update(${i},this.value)">` : row.name}</td>`;
      body.appendChild(tr);
    });
  }

  function update(i,val){
    data[i].name = val;
    localStorage.setItem('auctionData', JSON.stringify(data));
  }

  // Таймер
  const endTime = new Date(localStorage.getItem('endTime') || (()=>{
    const d=new Date(); d.setHours(d.getHours()+24); localStorage.setItem('endTime', d); return d;
  })());

  function tick(){
    const now = new Date();
    let diff = Math.max(0, endTime-now);
    const h = Math.floor(diff/36e5);
    const m = Math.floor(diff%36e5/6e4);
    const s = Math.floor(diff%6e4/1000);
    const el=document.getElementById('time');
    el.textContent = `${h}ч ${m}м ${s}с`;
    el.style.color = h < 5 ? 'red' : 'black';
  }
  setInterval(tick,1000);

  render(); tick();
</script>
</body>
</html>
